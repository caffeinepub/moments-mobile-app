{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 83,
  "summary": "Refine Moments into a minimal, behavior-shaping app centered on live→capture→confirm→quiet memory vault (avoid feed/social-media feel). Next steps: redesign the post-camera Save/Confirm screen pixel-by-pixel, collapse navigation into a strict 5-screen architecture, and remove the standalone Moments feed/tab from primary navigation (access memories via calendar/date + reflection/vault instead).",
  "existing_features": [
    {
      "id": "IF-1",
      "title": "Client-side routing across core app pages",
      "synonyms": [
        "TanStack Router navigation",
        "SPA routes"
      ],
      "description": "Defines and renders routes for '/', '/welcome', '/home', '/camera', '/settings', '/calendar', and '/moments' using TanStack Router with a root Outlet and per-page components.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-2",
      "title": "Mobile splash/onboarding slideshow with animated cards",
      "synonyms": [
        "Onboarding carousel",
        "Splash slideshow"
      ],
      "description": "Implements a 3-slide onboarding flow with card-style layouts (video on slide 1, images on slides 2–3), timed auto-advance (longer pause on slide 1), and manual Prev/Next navigation with directional transition state handling and synchronized background/progress dot colors.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-3",
      "title": "Internet Identity authentication context and login lifecycle",
      "synonyms": [
        "II auth provider",
        "AuthClient integration"
      ],
      "description": "Provides `InternetIdentityProvider` and `useInternetIdentity` to initialize an AuthClient, load persisted identity, login via Internet Identity with delegation TTL, expose status flags, and support logout via `clear()`.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-4",
      "title": "Smart splash-to-welcome navigation based on auth state",
      "synonyms": [
        "Authenticated redirect behavior"
      ],
      "description": "On the splash screen, once the user reaches slide 3 and an identity is present, the app navigates to '/welcome'. The sign-in button adapts to auth status ('Loading…', 'Connecting…', 'Continue', 'Sign In') and avoids re-login if already authenticated.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-5",
      "title": "ICP actor creation with identity-bound caching and access control initialization",
      "synonyms": [
        "useActor hook",
        "React Query actor cache"
      ],
      "description": "Creates an authenticated or anonymous backend actor via `createActorWithConfig`, caches it in React Query keyed by principal, extracts an admin secret from URL hash/session (`caffeineAdminToken`) and calls `_initializeAccessControlWithSecret`, then invalidates/refetches other queries when actor changes.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-6",
      "title": "Secure URL hash secret parameter handling",
      "synonyms": [
        "Admin token in hash",
        "Secret param extraction"
      ],
      "description": "Implements utilities to read secrets from URL hash, persist them in sessionStorage, and remove them from the URL to reduce history/referrer leakage risk.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-7",
      "title": "Welcome page with get-started and sign-out",
      "synonyms": [
        "Post-login landing"
      ],
      "description": "Displays a welcome card (04) and navigates to '/home' on 'Get Started'; supports signing out via `clear()` and returning to '/'.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-8",
      "title": "Home screen with header, search UI, promo card, and footer navigation",
      "synonyms": [
        "Dashboard",
        "Home UI"
      ],
      "description": "Renders a mobile home UI with profile/notification placeholders, a search bar, a promotional card, and a curved floating footer menu linking to camera, calendar, moments, and settings.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-9",
      "title": "Camera capability abstraction hook (getUserMedia)",
      "synonyms": [
        "useCamera hook",
        "MediaStream handling"
      ],
      "description": "Provides a reusable camera hook that checks support, starts/stops streams, switches facing mode, captures photos via canvas to a File, tracks loading/errors, and ensures cleanup on unmount.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-10",
      "title": "Camera screen with capture, retake, save, and upload-from-gallery",
      "synonyms": [
        "Camera UI",
        "Photo capture flow"
      ],
      "description": "Displays live camera preview with controls for capture and camera switching, allows manual image upload, supports photo review and saving, and persists images into localStorage as base64 with metadata before navigating back to home.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-11",
      "title": "LocalStorage-based Moments collection persistence",
      "synonyms": [
        "Local photo library",
        "Offline persistence"
      ],
      "description": "Stores captured/uploaded photos in localStorage (currently under `moments_photos`) with fields {id, data(base64), timestamp, type} and reads them back for display in the Moments viewer.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-12",
      "title": "Moments viewer with vertical swipe/scroll navigation and background music",
      "synonyms": [
        "TikTok-style viewer",
        "Vertical slideshow"
      ],
      "description": "Renders saved moments as a vertical full-screen slideshow with touch swipe detection, desktop wheel navigation, a photo counter, empty/loading states, and auto-play looping background audio.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-13",
      "title": "Calendar view with month navigation and per-date moments preview grid",
      "synonyms": [
        "Moments calendar",
        "Date browser"
      ],
      "description": "Implements a 6x7 grid calendar (restricted to year 2026) with today highlighting, date selection, month navigation, and loading/filtering of moment thumbnails for the selected date (currently wired to a localStorage key).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-14",
      "title": "Settings page UI with logout",
      "synonyms": [
        "Settings screen"
      ],
      "description": "Provides a settings layout with grouped list items (Account, Subscription, General, Privacy, Notifications, Appearance, Advanced, Help) and a functional 'Log out' action that clears identity and returns to splash.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-15",
      "title": "Tailwind + custom CSS animation/styling system",
      "synonyms": [
        "Design system",
        "CSS animations"
      ],
      "description": "Configures Tailwind with typography/container-queries/animate plugins and defines a custom OKLCH token-based theme, reusable button styles (yellow variants), thin mobile scrollbars, and key UI animations (slide-in, card transitions, fade-in).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-16",
      "title": "Backend role-based access control with admin bootstrap secret",
      "synonyms": [
        "RBAC",
        "AccessControl"
      ],
      "description": "Motoko access control module supports roles (#admin/#user/#guest), initialization where the first valid secret holder becomes admin, role assignment (admin-only), permission checks, and helper queries (`getCallerUserRole`, `isCallerAdmin`).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-17",
      "title": "Backend user profile storage with authorization checks",
      "synonyms": [
        "UserProfile API"
      ],
      "description": "Stores and retrieves simple user profiles keyed by Principal, allowing authenticated users to save their own profile and allowing admin/self profile access enforcement.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-18",
      "title": "Backend user settings storage with authorization checks",
      "synonyms": [
        "UserSettings API"
      ],
      "description": "Stores per-user settings (notifications, appearance, privacy) with authenticated user-only access for get/save operations.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-19",
      "title": "Backend moments photo metadata registry (scaffold)",
      "synonyms": [
        "PhotoMetadata API",
        "Moments backend scaffolding"
      ],
      "description": "Defines PhotoMetadata (id, owner, timestamp, blobId) and supports storing metadata references per user, listing caller/user photos (admin or owner), and deleting caller-owned metadata by id; blob storage integration is intended but not implemented in the provided code.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-20",
      "title": "Backend blob storage maintenance and authorization mixin",
      "synonyms": [
        "Caffeine storage mixin",
        "Dead blob pruning",
        "Cycles refill"
      ],
      "description": "Includes a blob-storage mixin that can update authorized gateway principals from an external cashier canister, check liveness/dead blobs, confirm deletion and trigger GC, and refill cycles from a cashier; enforces authorization for sensitive maintenance endpoints.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-21",
      "title": "Centralized localStorage persistence via StorageClient utility",
      "synonyms": [
        "StorageClient",
        "Local storage abstraction",
        "Unified storage keys"
      ],
      "description": "Introduces a shared `StorageClient` utility for reading/writing locally persisted app data (including moments/photos), reducing duplication across pages and preventing key mismatches between features like Camera, Moments, and Calendar.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-22",
      "title": "Calendar planned-moment creation flow (bottom sheet + relationship cards + time) with local persistence",
      "synonyms": [
        "Planned moments",
        "Calendar planning surface",
        "PlannedMomentBottomSheet"
      ],
      "description": "Extends the Calendar experience into a planning surface: selecting a date can open a planned-moment creation UI (bottom sheet) that captures planned time and \"who\" via relationship-category cards, persists planned moments locally (planned moments storage utilities/hooks), and surfaces saved/planned items for the selected date below the calendar in the same visual style as the app.",
      "reqIds": [
        "AR-5"
      ],
      "version": 1
    },
    {
      "id": "IF-23",
      "title": "Backend photo blob storage integration for Moments (store + retrieve)",
      "synonyms": [
        "storePhoto blob put",
        "getBlob implementation",
        "Photo blob persistence"
      ],
      "description": "Implements actual blob persistence and retrieval in the Motoko backend: `storePhoto` writes the provided photo blob into storage (instead of metadata-only scaffolding) and records a real timestamp; `getBlob` is implemented to fetch and return stored blobs via the storage interface/mixin rather than always returning null.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-24",
      "title": "Hamburger menu overlay component",
      "synonyms": [
        "HamburgerMenu",
        "Side menu"
      ],
      "description": "Adds a reusable HamburgerMenu UI component for exposing additional navigation/actions via a compact menu affordance in the mobile UI.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-25",
      "title": "Sign-in overlay component for authentication prompts",
      "synonyms": [
        "SignInOverlay",
        "Auth prompt overlay"
      ],
      "description": "Adds a dedicated SignInOverlay component to present a focused authentication prompt/CTA overlay when sign-in is required or beneficial within the app flow.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-26",
      "title": "Profile management UI with local-first persistence (name + profile picture)",
      "synonyms": [
        "Profile page",
        "useProfile hook",
        "profileStorage"
      ],
      "description": "Adds a Profile page and supporting hook/storage utilities to let users set/update a display name and profile picture, persisted locally (local-first) and loaded back into the UI; designed to integrate with Internet Identity when available without changing other page designs.",
      "reqIds": [
        "AR-18"
      ],
      "version": 1
    },
    {
      "id": "IF-28",
      "title": "Inline toast/notification component for lightweight in-app feedback",
      "synonyms": [
        "InlineToast"
      ],
      "description": "Introduces an InlineToast UI component to display compact, inline feedback messages in the mobile UI where needed.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-29",
      "title": "Automatic browser geolocation hook for default user location",
      "synonyms": [
        "useAutoGeolocation",
        "permission-based location retrieval"
      ],
      "description": "Adds a reusable `useAutoGeolocation` hook that automatically requests browser geolocation (permission-based) to fetch the user’s location by default and exposes loading/success/error/denied states so UI can handle unavailable/denied scenarios gracefully.",
      "reqIds": [
        "AR-22"
      ],
      "version": 1
    },
    {
      "id": "IF-30",
      "title": "Glassmorphic card styling adopted as default card standard (excluding buttons)",
      "synonyms": [
        "Glass card style",
        "Default glassmorphism"
      ],
      "description": "Updates the app’s card styling approach so that glassmorphic cards are the default visual standard across the UI (excluding buttons), aligning core surfaces to the new glass design direction.",
      "reqIds": [
        "AR-23"
      ],
      "version": 1
    },
    {
      "id": "IF-31",
      "title": "Post-camera Save/Confirm screen for captured moments",
      "synonyms": [
        "SaveMomentConfirmPage",
        "Save Moment confirmation UI"
      ],
      "description": "Adds a dedicated post-capture confirmation screen to review the photo and confirm/save the moment (minimal confirm step rather than immediate return to Home), aligning the capture→confirm flow.",
      "reqIds": [
        "AR-33"
      ],
      "version": 1
    },
    {
      "id": "IF-32",
      "title": "Vault screens for quiet memory access (vault list + single-moment view)",
      "synonyms": [
        "VaultPage",
        "VaultMomentPage",
        "Memory vault"
      ],
      "description": "Introduces Vault browsing surfaces (a vault page and a per-moment vault detail page) to access saved memories in a non-feed, private-vault style UI.",
      "reqIds": [
        "AR-32"
      ],
      "version": 1
    },
    {
      "id": "IF-33",
      "title": "Pending moment draft persistence utility for capture→confirm flow",
      "synonyms": [
        "pendingMomentDraftStorage",
        "pending draft storage"
      ],
      "description": "Adds a local persistence utility to store/retrieve an in-progress (pending) moment draft between capture and confirmation steps, improving reliability of the capture→confirm→save workflow.",
      "reqIds": [
        "AR-33"
      ],
      "version": 1
    },
    {
      "id": "IF-34",
      "title": "Post-moment emotional check-in page",
      "synonyms": [
        "MomentFeelingCheckPage",
        "How did this feel check-in"
      ],
      "description": "Adds a lightweight post-moment emotional check-in screen to capture a simple feeling response after completing/saving a moment.",
      "reqIds": [
        "AR-27"
      ],
      "version": 1
    },
    {
      "id": "IF-35",
      "title": "Centralized Moments photos hook and storage utilities",
      "synonyms": [
        "useMomentsPhotos",
        "momentsPhotosStorage"
      ],
      "description": "Introduces a dedicated hook and storage helpers to load/save Moments photos consistently, reducing duplication and improving cross-page access to saved moments.",
      "reqIds": [
        "AR-32"
      ],
      "version": 1
    },
    {
      "id": "feature-add-subtle-motion-to-the-vault-list-screen-to-reduce-the-static-bland-feel-animate-month-sections-and-photo-cards-on-initial-render-and-when-they-enter-the-viewport-e-g-fade-slide-up-slight-scale-and-add-a-gentle-pressed-tap-micro-interaction-on-card-click",
      "title": "Add subtle motion to the Vault list screen to reduce the static/bland feel: animate month sections and photo cards on initial render and when they enter the viewport (e.g., fade/slide-up + slight scale), and add a gentle pressed/tap micro-interaction on card click.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-redesign-vault-month-card-thumbnails-so-they-look-consistent-and-intentional-apply-the-app-s-glassmorphic-card-styling-standard-to-the-thumbnail-tiles-or-a-clearly-improved-equivalent-refine-spacing-radius-shadows-and-ensure-the-grid-reads-cleanly-on-mobile",
      "title": "Redesign Vault month card thumbnails so they look consistent and intentional: apply the app’s glassmorphic card styling standard to the thumbnail tiles (or a clearly improved equivalent), refine spacing/radius/shadows, and ensure the grid reads cleanly on mobile.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-vault-photos-render-as-true-square-thumbnails-across-all-supported-browsers-by-removing-reliance-on-tailwind-s-aspect-square-class-which-may-not-be-enabled-and-enforcing-a-square-layout-via-explicit-css-inline-aspect-ratio-fallback-keep-object-fit-cover-for-thumbnails-so-the-square-crop-is-consistent",
      "title": "Ensure Vault photos render as true square thumbnails across all supported browsers by removing reliance on Tailwind’s `aspect-square` class (which may not be enabled) and enforcing a square layout via explicit CSS/inline aspect-ratio fallback. Keep `object-fit: cover` for thumbnails so the square crop is consistent.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-the-enlarged-moment-viewing-experience-from-vault-thumbnails-so-the-user-always-gets-an-enlarged-clear-view-when-a-thumbnail-is-tapped-open-a-full-screen-view-that-prioritizes-the-image-high-contrast-background-no-unintended-compression-and-provide-an-obvious-close-back-control-ensure-the-route-vault-momentid-or-an-equivalent-modal-overlay-reliably-shows-the-full-image-and-feels-crisp",
      "title": "Improve the enlarged moment viewing experience from Vault thumbnails so the user always gets an enlarged, clear view: when a thumbnail is tapped, open a full-screen view that prioritizes the image (high contrast background, no unintended compression), and provide an obvious close/back control. Ensure the route `/vault/$momentId` (or an equivalent modal overlay) reliably shows the full image and feels “crisp”.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-the-same-subtle-pulsating-animation-used-for-the-camera-icon-button-camerapulse-camera-pulse-to-all-buttons-across-the-app-including-icon-only-buttons-like-back-arrows-while-ensuring-disabled-buttons-do-not-pulse-provide-a-safe-opt-out-mechanism-e-g-a-no-pulse-class-for-any-button-where-pulsing-harms-usability",
      "title": "Apply the same subtle pulsating animation used for the camera icon/button (`cameraPulse` / `.camera-pulse`) to all buttons across the app (including icon-only buttons like back arrows), while ensuring disabled buttons do not pulse. Provide a safe opt-out mechanism (e.g., a `no-pulse` class) for any button where pulsing harms usability.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Calendar UI: single-row weekly view with horizontal scroll (days slide left/right), changeable month, and refined current-day indicator styling to match design",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Calendar visual cleanup: reduce overall UI sizing, remove emojis, and eliminate unwanted blue elements to keep design clean and consistent",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Moment planning UX polish: keep bottom-sheet/scroll-up creation motion smooth while creating/planning a moment",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Planned-moment creation sheet: make Cancel/Save buttons smaller and color-coded (distinct per action) while keeping design clean",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Planned-moment bottom sheet: half-height (50% viewport), smooth eased translate in/out (no bounce), smaller less-wide Get Started–style Cancel/Save buttons (Cancel=red, Save=green), pill-style Time/Title inputs, and 'With who' cards styled like the reference (vacuum cleaner/wifi card style)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Calendar plan-creation bottom sheet adjustments: increase to ~75% viewport height, match 'With who' card styling to reference, and update Time input/picker UI to match reference (or close)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Calendar navigation controls: replace Prev/Next with small circular arrow buttons styled like the camera button",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "Planned moments color-coding: saved moments should be color-coded by selected 'who' category and the corresponding date indicator/circle should reflect the same color to show plans exist",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Planned-moment bottom sheet: increase height to ~75% viewport; redesign Time input as hour/minute boxes with +/- controls (and optional typing); apply 'who' color-coding using existing app palette and reflect it on the calendar date indicator",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "Add a curved floating bottom navbar styled like the search bar (pill outline, minimal padding) with small Font Awesome icons and active/hover color states",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-12",
      "summary": "Home screen header refinements: use uploaded Moments logo image (larger), profile picture placeholder, notification icon in a circle, narrower search pill, and a compact promo card with framed image + arrow + 'Add Your Moment' button",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "Post-capture completion/verification flow: after snapping/uploading a photo for a planned moment, allow user to verify it happened and show a dedicated minimalistic home/confirmation screen",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-14",
      "summary": "Profile management UI: let users set/update profile picture and display name within the profile section (without affecting other page designs)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Invites via codes: allow users to invite others to their memories/moments using shareable invite codes and an acceptance/join flow",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Product scope decision: evaluate removing/deprioritizing the standalone Moments section/feed to keep the app minimalistic, relying instead on calendar + verification views",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-17",
      "summary": "Home screen (post-capture verification): after user snaps evidence for a planned moment, show a dedicated minimal home/confirmation screen (exact UI clone of provided reference) and wire it into the planned→capture→verify flow without removing existing sections yet",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-19",
      "summary": "Invites via codes: generate/store shareable invite codes tied to user identity (local-first for now, backend-ready later) and provide UI to invite others to memories",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-24",
      "summary": "De-emphasize/limit any feed-style UI to avoid a social-media feel (reduce infinite scrolling surfaces; make memories feel like a private vault/timeline instead of a public feed)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-25",
      "summary": "Add 'connection gap' insights (derived from user behavior): e.g., time since last moment with key relationships, planned vs completed count, gentle awareness without guilt",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-26",
      "summary": "Add a default weekly 'anchor moment' (one recurring planned moment users can customize) to create rhythm with minimal setup",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-28",
      "summary": "Add monthly reflection/recap screen (quiet minimal recap of 3–5 memories + simple prompt) instead of heavy gamification",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-29",
      "summary": "Refine Moment Ideas to be situational/contextual (time-of-day, time available, who hasn't been seen recently) while keeping UI minimal",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-30",
      "summary": "Simplify Relationship Selector UX (limit choices up-front and progressively reveal more) to reduce overwhelm and keep the flow WHO→WHAT→WHEN fast",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-31",
      "summary": "Progress tracker redesign to be more human and less gamified (connected-with avatars, last meaningful moment highlight, gentle month-over-month comparison; avoid points/streak obsession)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-34",
      "summary": "Collapse/simplify the app into a 5-screen maximum architecture aligned to capture→confirm→vault (minimal navigation, reduced cognitive load)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-35",
      "summary": "Decide and implement which primary tab to remove/de-emphasize to eliminate feed-like browsing (e.g., remove/hidden Moments tab; access memories via calendar/reflection instead)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-36",
      "summary": "Vault UX polish: add subtle motion/animation so Vault doesn’t feel static/bland",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-37",
      "summary": "Vault cards redesign: improve card look/spacing; ensure photos render as square thumbnails",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-38",
      "summary": "Vault moment detail: tapping a Vault card should open an enlarged, clear photo view (non-feed)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-39",
      "summary": "Button animation standard: apply the same subtle pulsating motion used on the camera button to all buttons",
      "reqIds": [],
      "status": "pending"
    }
  ],
  "architectural_notes": [
    "Frontend uses React + TanStack Router for client-side routing and TanStack React Query for query caching; `useActor` creates and caches an authenticated/anonymous ICP actor instance keyed by the user principal.",
    "Internet Identity auth is encapsulated in a React Context provider (`InternetIdentityProvider`) using `@dfinity/auth-client`, with delegation validity checks and a 30-day TTL.",
    "Frontend UI is designed as a fixed-size mobile viewport (max 390x844) centered on screen, with Tailwind CSS utility classes and custom CSS animations (slide-in text, card transitions, dot bounces, etc.).",
    "Local-first data model: camera-captured images are converted to base64 and stored in `localStorage` for the Moments experience; pages read from localStorage rather than backend.",
    "Backend uses Motoko ‘mixin’ composition to include authorization and storage capabilities into the main canister actor.",
    "Backend access control: first initializer can become admin by providing a matching secret token (from an environment variable); other principals default to user role on initialization.",
    "Backend blob-storage helper uses environment variables to locate a ‘cashier’ canister and to fetch authorized gateway principals; includes maintenance methods for dead-blob pruning and cycles refill.",
    "Introduced a frontend `StorageClient` utility to centralize localStorage access and standardize storage keys/serialization used across pages (e.g., camera capture, moments viewer, calendar).",
    "Build template updated to include shadcn/ui component implementations (e.g., button, dialog, sheet, etc.) and related tooling/config (eslint rules, utils, hooks), expanding the UI component infrastructure available to the app.",
    "Added planned-moments local persistence layer (plannedMomentsStorage + usePlannedMoments hook) and a dedicated PlannedMomentBottomSheet component to support calendar-based planned moment creation and retrieval by date.",
    "Calendar planned-moment creation bottom sheet should be half-height (reaches ~50% screen), with smooth slide-up on open and smooth slide-down on close; inputs (time/title/etc.) should use pill-style containers consistent with the search bar theme; action buttons should be smaller and color-coded (Cancel=red, Save=green) while matching the app’s overall styling.",
    "Planned-moment creation bottom sheet should use a clean eased translate (no bounce) and open to ~50% viewport height; inputs (time/title/etc.) should use pill-style containers like the search bar theme; action buttons should be narrower/smaller in the Get Started button style and color-coded (Cancel=red, Save=green); relationship selection cards should match the reference card style (e.g., vacuum cleaner/wifi styling).",
    "Backend Moments photo APIs now integrate with blob storage: `storePhoto` persists the provided blob and records a real timestamp, and `getBlob` is implemented to retrieve stored blobs via the storage module/mixin (no longer a placeholder).",
    "Calendar planned-moment creation bottom sheet should be ~75% viewport height (not 50%).",
    "Planned-moment Time input UI should be custom: separate hour/minute boxes with +/- steppers and optional direct typing, styled to match reference.",
    "Added shared UI overlay components (e.g., HamburgerMenu, SignInOverlay) to centralize menu/auth prompt presentation across pages rather than duplicating page-level UI patterns.",
    "Added local-first profile persistence utilities (`profileStorage`) and a `useProfile` hook to load/save profile name + image without requiring backend connectivity.",
    "Introduced a reusable `MomentsImageCard` component and integrated it into the Home screen to render the new 'Moments image' section while preserving the existing Home layout.",
    "UI direction: adopt glassmorphic styling as the new default for card components app-wide (excluding buttons).",
    "Location behavior: use automatic browser geolocation (permission-based) to fetch user location by default; must handle denial/unavailable states gracefully.",
    "Introduced a `useAutoGeolocation` hook to centralize permission-based browser geolocation retrieval and provide consistent status/error handling across pages/components.",
    "Product direction: eliminate feed-style Moments browsing (no TikTok-style viewer/music/counters); moments should be accessed contextually (after capture confirmation, by date/calendar, and/or via reflection surfaces) to avoid social-media feel.",
    "Decision update: remove/de-emphasize the standalone Moments feed/tab from primary navigation to avoid social-media feel; moments should be accessed contextually (post-capture confirmation, by date/calendar, and via monthly reflection/vault surfaces).",
    "Plan: collapse navigation into a strict 5-screen architecture aligned to live→capture→confirm→remember (no browse-first/feed behavior).",
    "Plan: redesign the post-camera confirmation screen pixel-by-pixel to be minimal and non-social (photo preview + who + optional 1-sentence + Save; retake as secondary).",
    "Introduced a pending-moment draft local persistence layer (`pendingMomentDraftStorage`) to support a multi-step capture→confirm flow without losing state between screens.",
    "Added Vault surfaces (`VaultPage`, `VaultMomentPage`) as a non-feed memory access pattern for saved Moments.",
    "Added a `useMomentsPhotos` hook + `momentsPhotosStorage` utilities to centralize Moments photo persistence/loading across Camera/Calendar/Vault/other pages.",
    "Added a lightweight post-moment emotional check-in surface (`MomentFeelingCheckPage`) to capture a simple feeling response after saving a moment."
  ],
  "known_issues": [
    "Environment variable names appear inconsistent/typo-prone in blob storage: `CAFFFEINE_STORAGE_CASHIER_PRINCIPAL` (extra 'F') may not match intended deployment configuration.",
    "Duplicate/competing global CSS files exist (`frontend/src/index.css` and `frontend/index.css`), which can cause confusion or styling inconsistencies depending on build configuration; the app imports `./index.css` from `src/main.tsx` (i.e., `frontend/src/index.css`).",
    "Home screen 'Add Your Moment' promotional button has no click handler (non-functional call-to-action).",
    "Splash screen comments mention GSAP, but the shown implementation uses CSS classes; dependency/intent may be mismatched.",
    "UI regression: button styling changed globally after latest changes; user requests reverting all buttons to prior styling without altering overall design.",
    "UI regression: splash slide card animations/motion no longer behave as previously implemented; needs restoration to prior motion behavior.",
    "Calendar UI currently not matching desired design: needs single-row week view, smaller/cleaner styling (no emojis/blue), and smoother plan-creation sheet motion",
    "Camera capture/upload does not reliably persist photos to the Moments feed; users report Moments not updating after snapping a photo.",
    "Calendar behavior/functionality has been reported as 'dummy'/non-functional by the user; needs to be backed by real 2026 dates and user data rather than placeholder UI.",
    "Deployments are failing intermittently; user requests redeploy but build/deploy pipeline returns 'Deployment failed'.",
    "Deployment failures persist intermittently (redeploy attempts continue to fail), blocking rapid iteration/testing.",
    "Internet Identity sign-in reliability issue: sign-in/redirect does not work consistently across all browsers and may not handle already-signed-in users (reauth/continue) correctly.",
    "UI consistency: some card/container surfaces are still rendered as white instead of using the app-wide glassmorphic card styling standard (excluding buttons).",
    "Vault UX issue: Vault feels bland/static; cards look odd and tapping a card does not open an enlarged/clear photo view.",
    "Vault media rendering issue: photos should be square but currently are not consistently square."
  ],
  "isFixRequest": true,
  "gameProjectType": "none",
  "projectName": "Moments Mobile App",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}